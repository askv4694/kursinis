---
title: "Graphs"
author: "Asta KvedaraitÄ—"
date: "5/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("treemap")
install.packages("d3treeR")
install.packages("hrbrthemes")
```
# Dendrogram 
```{r}
sample <- read.csv("../../2darbas/output/correctedSample.csv")
beta <- readRDS("../../2darbas/output/betab.rds")
anno <- readRDS("../../Komanda/output/annotation.rds")

head(sample)
head(as.data.frame(anno))
head(as.data.frame(beta))

unique(sample$sample_plate)
chr8 <- anno[anno$chr == "chr8",]
chr8body <- chr8[chr8$UCSC_RefGene_Group == "Body",]
nrow(chr8)
as.data.frame(chr8body)


plate1 <- sample[sample$sample_plate == " Plate 1",]
plate1
nrow(plate1)
data <- beta[chr8body$Name, plate1$sample_id]
nrow(data)
ncol(data)
#data has chr8 and Plate_1
as.data.frame(data)
```

```{r}

hc <- hclust(dist(data))
dhc <- as.dendrogram(hc)

# set the margin
par(mar=c(4,4,2,2))

# Plot the Second group
plot(dhc[[2]] , main= "zoom on a part of the dendrogram")

plot(hc, labels = FALSE)

```
```{r}
#if(!require("rlang"))install.packages("rlang")
#if(!require("ggraph"))install.packages("ggraph")

file.edit(file.path("~", ".Rprofile"))
install.packages("rlang")

library(ggraph)
if(!require("igraph"))install.packages("igraph")
library(igraph)
library(tidyverse)
theme_set(theme_void())



ggraph(data, layout = 'dendrogram', circular = FALSE) + 
  geom_edge_diagonal() 

```




#RIDGELINE PLOT

# Libraries
library(tidyverse)
library(hrbrthemes)
install.packages("viridis")
library(viridis)

# Load dataset from github
data <- read.table("https://raw.githubusercontent.com/zonination/perceptions/master/probly.csv", header=TRUE, sep=",")
data <- data %>% 
  gather(key="text", value="value") %>%
  mutate(text = gsub("\\.", " ",text)) %>%
  mutate(value = round(as.numeric(value),0)) %>%
  filter(text %in% c("Almost Certainly","Very Good Chance","We Believe","Likely","About Even", "Little Chance", "Chances Are Slight", "Almost No Chance"))

install.packages("ggridges")
library(ggridges)

data %>%
  mutate(text = fct_reorder(text, value)) %>%
  ggplot( aes(y=text, x=value,  fill=text)) +
    geom_density_ridges(alpha=0.6, bandwidth=4) +
    scale_fill_viridis(discrete=TRUE) +
    scale_color_viridis(discrete=TRUE) +
    theme_ipsum() +
    theme(
      legend.position="none",
      panel.spacing = unit(0.1, "lines"),
      strip.text.x = element_text(size = 8)
    ) +
    xlab("") +
    ylab("Assigned Probability (%)")





as.data.frame(beta)
head(sample)
cor <- 1-cor(beta)
head(cor)
test <- data.frame(sample$sample_plate, sample$age)

treemap::treemap(test,
                 index = c("sample.sample_plate", "sample.age"),
                 vSize = "sample.age"
            )

